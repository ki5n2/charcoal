<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>DS 7. 회귀분석문제, GradientTape를 이용한 풀이, GradientTape + opt.apply_gradients를 이용한 풀이, opt.minimize를 이용한 풀이, tf.keras.Sequential | ki5n2</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="DS 7. 회귀분석문제, GradientTape를 이용한 풀이, GradientTape + opt.apply_gradients를 이용한 풀이, opt.minimize를 이용한 풀이, tf.keras.Sequential" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="작성완료" />
<meta property="og:description" content="작성완료" />
<link rel="canonical" href="https://ki5n2.github.io/charcoal/2022/04/06/DS.html" />
<meta property="og:url" content="https://ki5n2.github.io/charcoal/2022/04/06/DS.html" />
<meta property="og:site_name" content="ki5n2" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-04-06T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="DS 7. 회귀분석문제, GradientTape를 이용한 풀이, GradientTape + opt.apply_gradients를 이용한 풀이, opt.minimize를 이용한 풀이, tf.keras.Sequential" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-06T00:00:00-05:00","datePublished":"2022-04-06T00:00:00-05:00","description":"작성완료","headline":"DS 7. 회귀분석문제, GradientTape를 이용한 풀이, GradientTape + opt.apply_gradients를 이용한 풀이, opt.minimize를 이용한 풀이, tf.keras.Sequential","mainEntityOfPage":{"@type":"WebPage","@id":"https://ki5n2.github.io/charcoal/2022/04/06/DS.html"},"url":"https://ki5n2.github.io/charcoal/2022/04/06/DS.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/charcoal/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://ki5n2.github.io/charcoal/feed.xml" title="ki5n2" /><link rel="shortcut icon" type="image/x-icon" href="/charcoal/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/charcoal/">ki5n2</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/charcoal/about/">About Me</a><a class="page-link" href="/charcoal/search/">Search</a><a class="page-link" href="/charcoal/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">DS 7. 회귀분석문제, GradientTape를 이용한 풀이, GradientTape + opt.apply_gradients를 이용한 풀이, opt.minimize를 이용한 풀이, tf.keras.Sequential</h1><p class="page-description">작성완료</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-04-06T00:00:00-05:00" itemprop="datePublished">
        Apr 6, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      17 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/ki5n2/charcoal/tree/master/_notebooks/2022-04-06-DS.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/charcoal/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/ki5n2/charcoal/master?filepath=_notebooks%2F2022-04-06-DS.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/charcoal/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/ki5n2/charcoal/blob/master/_notebooks/2022-04-06-DS.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/charcoal/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fki5n2%2Fcharcoal%2Fblob%2Fmaster%2F_notebooks%2F2022-04-06-DS.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/charcoal/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#Data-Science">Data Science </a>
<ul>
<li class="toc-entry toc-h2"><a href="#회귀분석-문제">회귀분석 문제 </a>
<ul>
<li class="toc-entry toc-h3"><a href="#이론적-풀이">이론적 풀이 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#풀이1:-스칼라버전">풀이1: 스칼라버전 </a></li>
<li class="toc-entry toc-h4"><a href="#풀이2:-벡터버전">풀이2: 벡터버전 </a></li>
<li class="toc-entry toc-h4"><a href="#풀이3:-벡터버전,-손실함수의-도함수이용">풀이3: 벡터버전, 손실함수의 도함수이용 </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#GradientTape를-이용한-풀이">GradientTape를 이용한 풀이 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#풀이1:-벡터버전">풀이1: 벡터버전 </a></li>
<li class="toc-entry toc-h4"><a href="#풀이2:-스칼라버전">풀이2: 스칼라버전 </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#GradientTape-+-opt.apply_gradients를-이용한-풀이">GradientTape + opt.apply_gradients를 이용한 풀이 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#풀이1:-벡터버전">풀이1: 벡터버전 </a></li>
<li class="toc-entry toc-h4"><a href="#풀이2:-스칼라버전">풀이2: 스칼라버전 </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#opt.minimize를-이용한-풀이">opt.minimize를 이용한 풀이 </a>
<ul>
<li class="toc-entry toc-h4"><a href="#풀이1:-벡터버전,-사용자정의-손실함수(lambda)">풀이1: 벡터버전, 사용자정의 손실함수(lambda) </a></li>
<li class="toc-entry toc-h4"><a href="#풀이2:스칼라-버전,-사용자정의-손실함수(lambda)">풀이2:스칼라 버전, 사용자정의 손실함수(lambda) </a></li>
<li class="toc-entry toc-h4"><a href="#lambda-함수">lambda 함수 </a></li>
<li class="toc-entry toc-h4"><a href="#풀이3:-벡터버전,-사용자정의-손실함수(def)">풀이3: 벡터버전, 사용자정의 손실함수(def) </a></li>
<li class="toc-entry toc-h4"><a href="#풀이4:-벡터버전,-사용자정의-손실함수(def)">풀이4: 벡터버전, 사용자정의 손실함수(def) </a></li>
<li class="toc-entry toc-h4"><a href="#풀이5:-벡터버전,-사용자정의-손실함수(tf.losses.MSE)">풀이5: 벡터버전, 사용자정의 손실함수(tf.losses.MSE) </a></li>
<li class="toc-entry toc-h4"><a href="#풀이6:-벡터버전,-사용자정의-손실함수(tf.losses.MeanSquaredError)">풀이6: 벡터버전, 사용자정의 손실함수(tf.losses.MeanSquaredError) </a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#tf.keras.Sequential">tf.keras.Sequential </a>
<ul>
<li class="toc-entry toc-h4"><a href="#풀이1:-벡터버전,-사용자정의-손실함수">풀이1: 벡터버전, 사용자정의 손실함수 </a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-04-06-DS.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h1 id="Data-Science">
<a class="anchor" href="#Data-Science" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data Science<a class="anchor-link" href="#Data-Science"> </a>
</h1>
<ul>
<li>lenture: Data Science_5-2nd week of lectures.</li>
<li>lenture date: 2022-04-04</li>
<li>lecturer: Guebin choi</li>
<li>study date: 2022-04-06</li>
<li>author: Kione kim</li>
</ul>
<hr>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow.experimental.numpy</span> <span class="k">as</span> <span class="nn">tnp</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">experimental_enable_numpy_behavior</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="회귀분석-문제">
<a class="anchor" href="#%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D-%EB%AC%B8%EC%A0%9C" aria-hidden="true"><span class="octicon octicon-link"></span></a>회귀분석 문제<a class="anchor-link" href="#%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D-%EB%AC%B8%EC%A0%9C"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> ${\bf y} \approx 4 + 2.5 {\bf x}$</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">'.'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y_true</span><span class="p">,</span><span class="s1">'r--'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x264896df2b0&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h3 id="이론적-풀이">
<a class="anchor" href="#%EC%9D%B4%EB%A1%A0%EC%A0%81-%ED%92%80%EC%9D%B4" aria-hidden="true"><span class="octicon octicon-link"></span></a>이론적 풀이<a class="anchor-link" href="#%EC%9D%B4%EB%A1%A0%EC%A0%81-%ED%92%80%EC%9D%B4"> </a>
</h3>
<p><code>-</code> 지난 시간: 풀이1 ~ 풀이3</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이1:-스칼라버전">
<a class="anchor" href="#%ED%92%80%EC%9D%B41:-%EC%8A%A4%EC%B9%BC%EB%9D%BC%EB%B2%84%EC%A0%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이1: 스칼라버전<a class="anchor-link" href="#%ED%92%80%EC%9D%B41:-%EC%8A%A4%EC%B9%BC%EB%9D%BC%EB%B2%84%EC%A0%84"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<ul>
<li>$S_{xx}=$, $S_{xy}=$</li>
<li>$\hat{\beta}_0=$, $\hat{\beta}_1=$</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200]), TensorShape([200]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Sxx</span><span class="o">=</span><span class="nb">sum</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Sxy</span><span class="o">=</span><span class="nb">sum</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta1_hat</span> <span class="o">=</span> <span class="n">Sxy</span><span class="o">/</span><span class="n">Sxx</span>
<span class="n">beta0_hat</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">beta1_hat</span> <span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta0_hat</span><span class="p">,</span> <span class="n">beta1_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;tf.Tensor: shape=(), dtype=float64, numpy=2.4904666055923816&gt;,
 &lt;tf.Tensor: shape=(), dtype=float64, numpy=4.100304074383147&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이2:-벡터버전">
<a class="anchor" href="#%ED%92%80%EC%9D%B42:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이2: 벡터버전<a class="anchor-link" href="#%ED%92%80%EC%9D%B42:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<ul>
<li>$\hat{\beta}=(X'X)^{-1}X'y$</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float64'</span><span class="p">),</span><span class="n">x</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200, 2]), TensorShape([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span><span class="p">)</span> <span class="o">@</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(2, 1), dtype=float64, numpy=
array([[2.49046661],
       [4.10030407]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이3:-벡터버전,-손실함수의-도함수이용">
<a class="anchor" href="#%ED%92%80%EC%9D%B43:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98%EC%9D%98-%EB%8F%84%ED%95%A8%EC%88%98%EC%9D%B4%EC%9A%A9" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이3: 벡터버전, 손실함수의 도함수이용<a class="anchor-link" href="#%ED%92%80%EC%9D%B43:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98%EC%9D%98-%EB%8F%84%ED%95%A8%EC%88%98%EC%9D%B4%EC%9A%A9"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<ul>
<li>$loss'(\beta)=-2X'y +2X'X\beta$</li>
<li>$\beta_{new} = \beta_{old} - \alpha \times loss'(\beta_{old})$</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200, 2]), TensorShape([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(2, 1), dtype=int32, numpy=
array([[-5],
       [10]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$loss'(\beta) = -2X'y+2X'X\beta$</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">@</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span> 
<span class="n">slope</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(2, 1), dtype=float64, numpy=
array([[-1816.24745711],
       [ -709.49075016]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">step</span> <span class="o">=</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="n">slope</span>
<span class="n">step</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(2, 1), dtype=float64, numpy=
array([[181.62474571],
       [ 70.94907502]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="o">@</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
    <span class="n">step</span> <span class="o">=</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">slope</span>
    <span class="n">beta_hat</span> <span class="o">=</span> <span class="n">beta_hat</span> <span class="o">+</span> <span class="n">step</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(2, 1), dtype=float64, numpy=
array([[2.49046015],
       [4.10031613]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">'.'</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y_true</span><span class="p">,</span><span class="s1">'r--'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">X</span><span class="nd">@beta_hat</span><span class="p">,</span><span class="s1">'b--'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x264896a74f0&gt;]</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<h3 id="GradientTape를-이용한-풀이">
<a class="anchor" href="#GradientTape%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%92%80%EC%9D%B4" aria-hidden="true"><span class="octicon octicon-link"></span></a>GradientTape를 이용한 풀이<a class="anchor-link" href="#GradientTape%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%92%80%EC%9D%B4"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트 1: 그레디언트 테입  </span>
<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span> 
    <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span> 
<span class="c1"># 포인트 2: 미분 </span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span> 
<span class="c1"># 포인트 3: update </span>
<span class="n">beta_hat</span><span class="o">.</span><span class="n">assign_sub</span><span class="p">(</span><span class="n">slope</span><span class="o">*</span><span class="n">alph</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이1:-벡터버전">
<a class="anchor" href="#%ED%92%80%EC%9D%B41:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이1: 벡터버전<a class="anchor-link" href="#%ED%92%80%EC%9D%B41:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 선언</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float64'</span><span class="p">),</span><span class="n">x</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200, 2]), TensorShape([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">10.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(2, 1), dtype=float64, numpy=
array([[ -5.],
       [-10.]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 임의의 beta_hat 선언</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">10.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[ -5.],
       [-10.]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">(</span><span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
    <span class="c1"># tape.watch(beta_hat)</span>
    <span class="n">yhat</span><span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span>
    <span class="n">loss</span><span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span> <span class="n">yhat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">yhat</span><span class="p">)</span> <span class="o">/</span><span class="n">N</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>loss를 SSE를 N으로 나눈 MSE를 사용함!</li>
<li>SSE를 최소화하는 $beta$값이나 SSE를 N으로 나눈 MSE를 최소화 하는 $beta$값이랑 같기 때문에 MSE를 사용!</li>
<li>보통 SSE를 사용하긴 하지만, 머신러닝 &amp; 딮러닝에선 MSE를 많이 사용함!</li>
<li>MSE를 사용함으로써 loss값이 N으로 나눈 만큼 작아지기 때문에 alpha값을 지난 시간보다 키웠음 !</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span> <span class="c1"># loss를 beta_hat으로 미분</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(2, 1), dtype=float64, numpy=
array([[-29.08123729],
       [-16.91428792]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>미분 값 -&gt; slope</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 반복</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">(</span><span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
        <span class="n">yhat</span><span class="o">=</span><span class="n">X</span><span class="nd">@beta_hat</span>
        <span class="n">loss</span><span class="o">=</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">slope</span><span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
    <span class="n">beta_hat</span><span class="o">.</span><span class="n">assign_sub</span><span class="p">(</span><span class="n">slope</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[2.49047318],
       [4.1002918 ]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>풀이1~3에서 구한 $\beta$ 값과 같음</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이2:-스칼라버전">
<a class="anchor" href="#%ED%92%80%EC%9D%B42:-%EC%8A%A4%EC%B9%BC%EB%9D%BC%EB%B2%84%EC%A0%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이2: 스칼라버전<a class="anchor-link" href="#%ED%92%80%EC%9D%B42:-%EC%8A%A4%EC%B9%BC%EB%9D%BC%EB%B2%84%EC%A0%84"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트 : 미분</span>
<span class="n">slope0</span><span class="p">,</span> <span class="n">slope1</span> <span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,[</span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200]), TensorShape([200]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta0_hat</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">beta1_hat</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">(</span><span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
        <span class="n">yhat</span><span class="o">=</span> <span class="n">beta0_hat</span> <span class="o">+</span> <span class="n">beta1_hat</span><span class="o">*</span><span class="n">x</span>
        <span class="n">loss</span><span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">slope0</span><span class="p">,</span> <span class="n">slope1</span><span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,[</span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">])</span>
    <span class="n">beta0_hat</span><span class="o">.</span><span class="n">assign_sub</span><span class="p">(</span><span class="n">slope0</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">beta1_hat</span><span class="o">.</span><span class="n">assign_sub</span><span class="p">(</span><span class="n">slope1</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=2.4904754&gt;,
 &lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=4.1002874&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">(</span><span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
        <span class="n">yhat</span><span class="o">=</span> <span class="p">,,,</span>
        <span class="n">loss</span><span class="o">=</span> <span class="p">,,,</span>
    <span class="n">slope0</span><span class="p">,</span> <span class="n">slope1</span><span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,[</span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">])</span>
    <span class="n">beta0_hat</span><span class="o">.</span><span class="n">assign_sub</span><span class="p">(</span><span class="n">slope0</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">beta1_hat</span><span class="o">.</span><span class="n">assign_sub</span><span class="p">(</span><span class="n">slope1</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>

<span class="p">:</span> <span class="mf">1.</span> <span class="n">loss를</span> <span class="n">beta0</span><span class="p">,</span> <span class="n">beta1으로</span> <span class="n">각각</span> <span class="n">미분</span> <span class="o">-&gt;</span> <span class="n">미분</span> <span class="n">값</span> <span class="mi">2</span><span class="n">개</span> <span class="n">나오는데</span><span class="p">,</span> <span class="n">beta0로</span> <span class="n">미분해준</span> <span class="n">값을</span> <span class="n">slope0로</span><span class="p">,</span> <span class="n">beta1로</span> <span class="n">미분해준</span> <span class="n">값을</span> <span class="n">slope1로</span> <span class="n">받아줌</span><span class="err">!!</span> 
  <span class="mf">2.</span> <span class="n">beta0_hat</span><span class="p">,</span> <span class="n">beta1_hat값을</span> <span class="n">각각</span> <span class="n">변경</span><span class="err">!</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>코드에는 문제없지만, 시간이 매우 오래걸림..! </li>
<li>다음과 같이 코딩하는 것이 훨씬 빠름!</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> <code>sum()</code> 대신 <code>tf.reduce_sum</code> 사용!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">(</span><span class="n">persistent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
        <span class="n">yhat</span><span class="o">=</span> <span class="n">beta0_hat</span> <span class="o">+</span> <span class="n">beta1_hat</span><span class="o">*</span><span class="n">x</span>
        <span class="n">loss</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">slope0</span><span class="p">,</span> <span class="n">slope1</span><span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,[</span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">])</span>
    <span class="n">beta0_hat</span><span class="o">.</span><span class="n">assign_sub</span><span class="p">(</span><span class="n">slope0</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">beta1_hat</span><span class="o">.</span><span class="n">assign_sub</span><span class="p">(</span><span class="n">slope1</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=2.4904754&gt;,
 &lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=4.1002874&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="GradientTape-+-opt.apply_gradients를-이용한-풀이">
<a class="anchor" href="#GradientTape-+-opt.apply_gradients%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%92%80%EC%9D%B4" aria-hidden="true"><span class="octicon octicon-link"></span></a>GradientTape + opt.apply_gradients를 이용한 풀이<a class="anchor-link" href="#GradientTape-+-opt.apply_gradients%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%92%80%EC%9D%B4"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이1:-벡터버전">
<a class="anchor" href="#%ED%92%80%EC%9D%B41:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이1: 벡터버전<a class="anchor-link" href="#%ED%92%80%EC%9D%B41:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트: 업데이트 방식</span>
<span class="n">opt</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">([(</span><span class="n">slope</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)])</span>  <span class="c1"># pair의 list가 입력되어야 함!!</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float64'</span><span class="p">),</span><span class="n">x</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200, 2]), TensorShape([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">10.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[ -5.],
       [-10.]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> <code>optimizer</code> 선언</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>iter1</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
    <span class="n">yhat</span><span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span>
    <span class="n">loss</span><span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
<span class="n">slope</span><span class="o">=</span><span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
<span class="n">opt</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">([(</span><span class="n">slope</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'UnreadVariable' shape=() dtype=int64, numpy=1&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[-2.09187623],
       [-8.30857118]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>한 번 미분한 값!</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>iter 반복</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
        <span class="n">yhat</span><span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span>
        <span class="n">loss</span><span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">slope</span><span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">([(</span><span class="n">slope</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[2.49047309],
       [4.10029197]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>opt.apply_gradients([(slope,beta_hat)])</code>는 <code>beta_hat.assign_sub(slope*alpha)</code>와 같은 기능(업데이트)을 하는 코드</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이2:-스칼라버전">
<a class="anchor" href="#%ED%92%80%EC%9D%B42:-%EC%8A%A4%EC%B9%BC%EB%9D%BC%EB%B2%84%EC%A0%84" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이2: 스칼라버전<a class="anchor-link" href="#%ED%92%80%EC%9D%B42:-%EC%8A%A4%EC%B9%BC%EB%9D%BC%EB%B2%84%EC%A0%84"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트코드: loss beta0_hat, beta1_hat으로 각각 미분 -&gt; 각각의 slope 값</span>
<span class="n">slope0</span><span class="p">,</span> <span class="n">slope1</span><span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,[</span><span class="n">beta0_hat</span><span class="p">,</span> <span class="n">beta1_hat</span><span class="p">])</span>
<span class="c1"># 포인트코드: 업데이트 </span>
<span class="n">opt</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">([(</span><span class="n">slope0</span><span class="p">,</span><span class="n">beta0_hat</span><span class="p">),(</span><span class="n">slope1</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">)])</span> <span class="c1"># pair의 list가 입력</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200]), TensorShape([200]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta0_hat</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">beta1_hat</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">GradientTape</span><span class="p">()</span> <span class="k">as</span> <span class="n">tape</span><span class="p">:</span>
        <span class="n">yhat</span><span class="o">=</span> <span class="n">beta0_hat</span> <span class="o">+</span> <span class="n">beta1_hat</span><span class="o">*</span><span class="n">x</span>
        <span class="n">loss</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">slope0</span><span class="p">,</span> <span class="n">slope1</span><span class="o">=</span> <span class="n">tape</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">loss</span><span class="p">,[</span><span class="n">beta0_hat</span><span class="p">,</span> <span class="n">beta1_hat</span><span class="p">])</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">apply_gradients</span><span class="p">([(</span><span class="n">slope0</span><span class="p">,</span><span class="n">beta0_hat</span><span class="p">),</span> <span class="p">(</span><span class="n">slope1</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=2.4904754&gt;,
 &lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=4.1002874&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="opt.minimize를-이용한-풀이">
<a class="anchor" href="#opt.minimize%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%92%80%EC%9D%B4" aria-hidden="true"><span class="octicon octicon-link"></span></a>opt.minimize를 이용한 풀이<a class="anchor-link" href="#opt.minimize%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-%ED%92%80%EC%9D%B4"> </a>
</h3>
<p>: tf.GradientTape를 사용하지 않아도 됨. 어떤 계산식에 의해 미분값이 계산되는지 몰라도 쓸 수 있는 코드</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이1:-벡터버전,-사용자정의-손실함수(lambda)">
<a class="anchor" href="#%ED%92%80%EC%9D%B41:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(lambda)" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이1: 벡터버전, 사용자정의 손실함수(lambda)<a class="anchor-link" href="#%ED%92%80%EC%9D%B41:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(lambda)"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트1: 손실함수 정의 </span>
<span class="n">loss_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="p">,,,</span>

<span class="c1"># 포인트2: 옵티마이저</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>

<span class="c1"># 포인트3: 미분 &amp; 업데이트 = minimize </span>
<span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float64'</span><span class="p">),</span><span class="n">x</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200, 2]), TensorShape([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">beta_hat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">10.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[ -5.],
       [-10.]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">미분할</span> <span class="n">식</span><span class="p">,</span> <span class="n">미분하고자</span> <span class="n">하는</span> <span class="n">값</span><span class="p">)</span><span class="n">는</span> <span class="n">미분</span> <span class="o">+</span> <span class="n">update를</span> <span class="n">동시에</span> <span class="n">수행</span>

<span class="mf">1.</span> <span class="n">loss와</span> <span class="n">beta_hat값만</span> <span class="n">전달해주면</span> <span class="n">됨</span><span class="err">!!</span>
<span class="mf">2.</span> <span class="n">loss는</span> <span class="n">사용자정의</span> <span class="n">함수로</span> <span class="n">전달</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss_fn</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:(</span><span class="n">y</span><span class="o">-</span><span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span><span class="p">)</span><span class="o">/</span> <span class="n">N</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>iter1</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'UnreadVariable' shape=() dtype=int64, numpy=1&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[-2.09187623],
       [-8.30857118]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>iter반복</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[2.49047309],
       [4.10029197]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이2:스칼라-버전,-사용자정의-손실함수(lambda)">
<a class="anchor" href="#%ED%92%80%EC%9D%B42:%EC%8A%A4%EC%B9%BC%EB%9D%BC-%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(lambda)" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이2:스칼라 버전, 사용자정의 손실함수(lambda)<a class="anchor-link" href="#%ED%92%80%EC%9D%B42:%EC%8A%A4%EC%B9%BC%EB%9D%BC-%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(lambda)"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트: 미분 &amp; 업데이트 = minimize </span>
<span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,[</span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200]), TensorShape([200]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta0_hat</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">)</span>
<span class="n">beta1_hat</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss_fn</span><span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="p">(</span><span class="n">beta0_hat</span><span class="o">+</span><span class="n">beta1_hat</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>iter1</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,[</span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'UnreadVariable' shape=() dtype=int64, numpy=1&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=-2.0918763&gt;,
 &lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=-8.308571&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>iter반복</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,[</span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta0_hat</span><span class="p">,</span><span class="n">beta1_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=2.4904754&gt;,
 &lt;tf.Variable 'Variable:0' shape=() dtype=float32, numpy=4.1002874&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="lambda-함수">
<a class="anchor" href="#lambda-%ED%95%A8%EC%88%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>lambda 함수<a class="anchor-link" href="#lambda-%ED%95%A8%EC%88%98"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 입력이 있는 형태</p>
<ul>
<li>
<code>lambda x: x**2</code> =&gt; <code>lambda(x) = x^2</code>
</li>
<li>
<code>lambda x,y: x+y</code> =&gt; <code>lambda(x,y) = x+y</code>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 입력이 없는 형태</p>
<ul>
<li>
<code>lambda: y</code> =&gt; <code>lamnda() = y</code>
</li>
</ul>
<p>: 입력이 무엇이든 <code>y</code>를 출력하는 함수!</p>
<p>-&gt; <code>lambda: tf.reduce_sum((y-(beta0_hat+beta1_hat*x))**2)</code> =&gt; <code>lambda() = tf.reduce_sum(y-(beta0_hat+beta1_hat*x))</code></p>
<p>: 입력이 무엇이든 <code>tf.reduce_sum(y-(beta0_hat+beta1_hat*x))</code>를 출력하는 함수</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이3:-벡터버전,-사용자정의-손실함수(def)">
<a class="anchor" href="#%ED%92%80%EC%9D%B43:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(def)" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이3: 벡터버전, 사용자정의 손실함수(def)<a class="anchor-link" href="#%ED%92%80%EC%9D%B43:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(def)"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트: 손실함수정의 </span>
<span class="k">def</span> <span class="nf">loss_fn</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">,,,</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float64'</span><span class="p">),</span><span class="n">x</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200, 2]), TensorShape([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">beta_hat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">10.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[ -5.],
       [-10.]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_fn</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="n">X</span><span class="nd">@beta_hat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">X</span><span class="nd">@beta_hat</span><span class="p">))</span> <span class="o">/</span> <span class="n">N</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>iter1</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'UnreadVariable' shape=() dtype=int64, numpy=1&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[-2.09187623],
       [-8.30857118]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>iter반복</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[2.49047309],
       [4.10029197]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 코드가 좋은 이유: 사용자 정의 함수를 내가 원하는 형태로 정의하여 사용할 수 있음!</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이4:-벡터버전,-사용자정의-손실함수(def)">
<a class="anchor" href="#%ED%92%80%EC%9D%B44:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(def)" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이4: 벡터버전, 사용자정의 손실함수(def)<a class="anchor-link" href="#%ED%92%80%EC%9D%B44:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(def)"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트: 손실함수정의 </span>
<span class="k">def</span> <span class="nf">loss_fn</span><span class="p">():</span>
    <span class="n">yhat</span><span class="o">=</span>
    <span class="n">loss</span><span class="o">=</span>
    <span class="p">,,,</span>
    <span class="k">return</span> <span class="n">loss</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 예시</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_fn</span><span class="p">():</span>
    <span class="n">yhat</span><span class="o">=</span> <span class="n">X</span><span class="nd">@beta_hat</span>
    <span class="n">loss</span><span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
    <span class="k">return</span> <span class="n">loss</span> <span class="c1"># loss가 출력</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>입력값이 무엇이든 loss가 출력됨. loss는 우리가 미분하고자 하는 식</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[2.49046661],
       [4.10030407]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>내가 원하는 형태의 코딩이 가능</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이5:-벡터버전,-사용자정의-손실함수(tf.losses.MSE)">
<a class="anchor" href="#%ED%92%80%EC%9D%B45:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(tf.losses.MSE)" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이5: 벡터버전, 사용자정의 손실함수(tf.losses.MSE)<a class="anchor-link" href="#%ED%92%80%EC%9D%B45:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(tf.losses.MSE)"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트: 이미 구현되어 있는 손실함수 이용 </span>
<span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MSE</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">yhat</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MSE</span><span class="p">(</span><span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">]),</span> <span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(), dtype=float64, numpy=4.666666666666667&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">+</span><span class="mi">9</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>4.666666666666667</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float64'</span><span class="p">),</span><span class="n">x</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200, 2]), TensorShape([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">beta_hat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">10.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[ -5.],
       [-10.]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yhat</span><span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MSE</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">yhat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(200,), dtype=float64, numpy=
array([ 46.96022558,  60.70686684,  72.30282228,  81.2802598 ,
        57.80729918,  43.17952069,  58.53054446,  58.31180694,
        61.85092764,  58.31730177,  79.71547263,  78.60501259,
        71.99894261,  75.00602384,  85.12349938,  55.10406785,
        73.69786462,  80.95467083,  74.6669447 ,  75.82773797,
        85.53770852,  67.22515134,  83.92316782,  82.73476828,
        83.61351332,  71.88184929,  98.56777325, 100.69671217,
       106.00993654,  99.11303261,  75.80120511,  66.43965872,
        93.29103212,  92.02161062, 103.43848691,  91.95513609,
        89.55063202, 102.5791008 , 104.04281702,  95.9503876 ,
       122.33084547, 110.14601438, 107.8128172 , 107.24683005,
       114.95773419, 118.679864  , 114.32865366, 106.48965615,
       138.72702545, 121.53161946, 127.26461033, 118.57340053,
       113.79996022, 127.69733957, 123.58570914, 132.75464371,
       125.47854101, 139.15373989, 146.19252441, 163.53659744,
       139.09846468, 150.22094322, 147.44621794, 120.55776355,
       146.73702063, 140.88032213, 146.51914749, 153.16727863,
       157.2906466 , 140.12227851, 160.75774017, 160.93203199,
       158.35458953, 186.0423395 , 160.32743626, 144.22928985,
       174.58984164, 155.97987705, 161.68940014, 179.58376217,
       169.20486627, 164.32615346, 180.49631444, 183.26489411,
       207.81251795, 176.71076052, 186.4834373 , 176.17945897,
       183.78631202, 192.71936065, 216.82573734, 183.60108262,
       185.18643139, 182.91320649, 181.51531937, 208.87678113,
       204.10382008, 181.3811454 , 186.22041838, 208.35807508,
       223.05341586, 217.99062832, 220.93169073, 227.48967225,
       204.52370814, 210.56012546, 224.69852368, 247.41250168,
       236.42542716, 229.40708813, 248.79603539, 261.46634784,
       255.29328625, 278.7301513 , 266.50963835, 232.72414492,
       253.7221811 , 247.85548131, 244.07870316, 257.84948971,
       234.30508042, 274.1894823 , 263.817655  , 242.73380909,
       286.68409303, 249.79602287, 245.53710442, 269.04506651,
       262.6498617 , 304.44265244, 287.7068894 , 302.79565392,
       270.90160857, 288.45621453, 266.58616864, 300.3959935 ,
       277.55271521, 283.66872636, 310.29812029, 279.93301006,
       302.14354378, 285.56093353, 279.93862274, 327.14046516,
       287.59085982, 319.80234296, 360.65183304, 348.50598211,
       314.8949131 , 373.42098076, 315.07724343, 342.10914738,
       328.23671337, 306.01509384, 373.78602342, 298.40856652,
       334.71498126, 367.58615747, 359.76181244, 350.63126972,
       356.18123273, 351.43013181, 365.19477051, 383.69790541,
       382.51460136, 347.73682534, 388.30267436, 382.64077176,
       350.86181903, 368.12582049, 377.51971677, 380.33371329,
       369.39525218, 405.61158059, 401.83207386, 391.55433637,
       403.07036866, 393.6718148 , 422.72367689, 377.48186669,
       415.07489252, 449.02617032, 414.40741051, 422.1835654 ,
       454.60513137, 412.48139172, 439.92130854, 422.2543035 ,
       417.95789578, 419.90903882, 441.76601488, 441.88258781,
       414.02012705, 477.63963252, 438.21558695, 451.38032516,
       436.86552668, 440.611652  , 465.06080711, 474.2370458 ])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>매트릭스 형태로 되어 있어 벡터 형태로 변환해서 입력해야 함</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MSE</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">yhat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(), dtype=float64, numpy=228.42737562724935&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 손실함수 정의</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_fn</span><span class="p">():</span>
    <span class="n">yhat</span><span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span>
    <span class="n">loss</span><span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MSE</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">yhat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">beta_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[2.49047318],
       [4.1002918 ]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>단점: 차원을 조절해주어야 함. 스칼라 값이 나오도록,,</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이6:-벡터버전,-사용자정의-손실함수(tf.losses.MeanSquaredError)">
<a class="anchor" href="#%ED%92%80%EC%9D%B46:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(tf.losses.MeanSquaredError)" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이6: 벡터버전, 사용자정의 손실함수(tf.losses.MeanSquaredError)<a class="anchor-link" href="#%ED%92%80%EC%9D%B46:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98(tf.losses.MeanSquaredError)"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트: 클래스로부터 손실함수 오브젝트 생성 (함수를 찍어내는 클래스) </span>
<span class="n">mse_fn</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MeanSquaredError</span><span class="p">()</span>
<span class="n">mse_fn</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">yhat</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float64'</span><span class="p">),</span><span class="n">x</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200, 2]), TensorShape([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">beta_hat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span><span class="o">-</span><span class="mf">10.0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[ -5.],
       [-10.]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mseloss_fn</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MeanSquaredError</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mseloss_fn</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">yhat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Tensor: shape=(), dtype=float64, numpy=228.4273681640625&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이것도 스칼라 값이 나오도록 차원을 조절해주어야 함!</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 손실함수 정의</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_fn</span><span class="p">():</span>
    <span class="n">yhat</span><span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span>
    <span class="n">loss</span><span class="o">=</span> <span class="n">mseloss_fn</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">yhat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">beta_hat</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;tf.Variable 'Variable:0' shape=(2, 1) dtype=float64, numpy=
array([[2.49047309],
       [4.10029197]])&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 오류</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_fn</span><span class="p">():</span>
    <span class="n">yhat</span><span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta_hat</span>
    <span class="n">loss</span><span class="o">=</span>  <span class="n">tf</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">MeanSquaredError</span><span class="p">((</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">yhat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">loss</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span><span class="n">beta_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ValueError</span>                                Traceback (most recent call last)
Input <span class="ansi-green-intense-fg ansi-bold">In [326]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">      1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> epoc <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">range</span>(<span style="color: rgb(98,98,98)">1000</span>):
<span class="ansi-green-intense-fg ansi-bold">----&gt; 2</span>     <span class="ansi-yellow-bg">opt</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">minimize</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">loss_fn</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">beta_hat</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-intense-fg ansi-bold">~\anaconda3\envs\ds2022\lib\site-packages\keras\optimizer_v2\optimizer_v2.py:530</span>, in <span class="ansi-cyan-fg">OptimizerV2.minimize</span><span class="ansi-blue-intense-fg ansi-bold">(self, loss, var_list, grad_loss, name, tape)</span>
<span class="ansi-green-fg">    499</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">minimize</span>(<span style="color: rgb(0,135,0)">self</span>, loss, var_list, grad_loss<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>, name<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>, tape<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>):
<span class="ansi-green-fg">    500</span>   <span style="color: rgb(175,0,0)">"""Minimize `loss` by updating `var_list`.</span>
<span class="ansi-green-fg">    501</span> 
<span class="ansi-green-fg">    502</span> <span style="color: rgb(175,0,0)">  This method simply computes gradient using `tf.GradientTape` and calls</span>
<span class="ansi-green-intense-fg ansi-bold">   (...)</span>
<span class="ansi-green-fg">    528</span> 
<span class="ansi-green-fg">    529</span> <span style="color: rgb(175,0,0)">  """</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 530</span>   grads_and_vars <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">_compute_gradients</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">    531</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">loss</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">var_list</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">var_list</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">grad_loss</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">grad_loss</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">tape</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">tape</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    532</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>apply_gradients(grads_and_vars, name<span style="color: rgb(98,98,98)">=</span>name)

File <span class="ansi-green-intense-fg ansi-bold">~\anaconda3\envs\ds2022\lib\site-packages\keras\optimizer_v2\optimizer_v2.py:574</span>, in <span class="ansi-cyan-fg">OptimizerV2._compute_gradients</span><span class="ansi-blue-intense-fg ansi-bold">(self, loss, var_list, grad_loss, tape)</span>
<span class="ansi-green-fg">    572</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> callable(var_list):
<span class="ansi-green-fg">    573</span>   tape<span style="color: rgb(98,98,98)">.</span>watch(var_list)
<span class="ansi-green-intense-fg ansi-bold">--&gt; 574</span> loss <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">loss</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    575</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> callable(var_list):
<span class="ansi-green-fg">    576</span>   var_list <span style="color: rgb(98,98,98)">=</span> var_list()

Input <span class="ansi-green-intense-fg ansi-bold">In [325]</span>, in <span class="ansi-cyan-fg">loss_fn</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-fg">      1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">loss_fn</span>():
<span class="ansi-green-fg">      2</span>     yhat<span style="color: rgb(98,98,98)">=</span> X <span style="color: rgb(98,98,98)">@</span> beta_hat
<span class="ansi-green-intense-fg ansi-bold">----&gt; 3</span>     loss<span style="color: rgb(98,98,98)">=</span>  <span class="ansi-yellow-bg">tf</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">losses</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">MeanSquaredError</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">reshape</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">-</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">1</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">yhat</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">reshape</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">-</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">1</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">      4</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> loss

File <span class="ansi-green-intense-fg ansi-bold">~\anaconda3\envs\ds2022\lib\site-packages\keras\losses.py:310</span>, in <span class="ansi-cyan-fg">MeanSquaredError.__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, reduction, name)</span>
<span class="ansi-green-fg">    293</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>,
<span class="ansi-green-fg">    294</span>              reduction<span style="color: rgb(98,98,98)">=</span>losses_utils<span style="color: rgb(98,98,98)">.</span>ReductionV2<span style="color: rgb(98,98,98)">.</span>AUTO,
<span class="ansi-green-fg">    295</span>              name<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">'</span><span style="color: rgb(175,0,0)">mean_squared_error</span><span style="color: rgb(175,0,0)">'</span>):
<span class="ansi-green-fg">    296</span>   <span style="color: rgb(175,0,0)">"""Initializes `MeanSquaredError` instance.</span>
<span class="ansi-green-fg">    297</span> 
<span class="ansi-green-fg">    298</span> <span style="color: rgb(175,0,0)">  Args:</span>
<span class="ansi-green-intense-fg ansi-bold">   (...)</span>
<span class="ansi-green-fg">    308</span> <span style="color: rgb(175,0,0)">    name: Optional name for the instance. Defaults to 'mean_squared_error'.</span>
<span class="ansi-green-fg">    309</span> <span style="color: rgb(175,0,0)">  """</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 310</span>   <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">super</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg" style="color: rgb(0,0,255)">__init__</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">mean_squared_error</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">reduction</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">reduction</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-intense-fg ansi-bold">~\anaconda3\envs\ds2022\lib\site-packages\keras\losses.py:227</span>, in <span class="ansi-cyan-fg">LossFunctionWrapper.__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, fn, reduction, name, **kwargs)</span>
<span class="ansi-green-fg">    205</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>,
<span class="ansi-green-fg">    206</span>              fn,
<span class="ansi-green-fg">    207</span>              reduction<span style="color: rgb(98,98,98)">=</span>losses_utils<span style="color: rgb(98,98,98)">.</span>ReductionV2<span style="color: rgb(98,98,98)">.</span>AUTO,
<span class="ansi-green-fg">    208</span>              name<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,
<span class="ansi-green-fg">    209</span>              <span style="color: rgb(98,98,98)">*</span><span style="color: rgb(98,98,98)">*</span>kwargs):
<span class="ansi-green-fg">    210</span>   <span style="color: rgb(175,0,0)">"""Initializes `LossFunctionWrapper` class.</span>
<span class="ansi-green-fg">    211</span> 
<span class="ansi-green-fg">    212</span> <span style="color: rgb(175,0,0)">  Args:</span>
<span class="ansi-green-intense-fg ansi-bold">   (...)</span>
<span class="ansi-green-fg">    225</span> <span style="color: rgb(175,0,0)">    **kwargs: The keyword arguments that are passed on to `fn`.</span>
<span class="ansi-green-fg">    226</span> <span style="color: rgb(175,0,0)">  """</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 227</span>   <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">super</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg" style="color: rgb(0,0,255)">__init__</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">reduction</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">reduction</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">=</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    228</span>   <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>fn <span style="color: rgb(98,98,98)">=</span> fn
<span class="ansi-green-fg">    229</span>   <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>_fn_kwargs <span style="color: rgb(98,98,98)">=</span> kwargs

File <span class="ansi-green-intense-fg ansi-bold">~\anaconda3\envs\ds2022\lib\site-packages\keras\losses.py:88</span>, in <span class="ansi-cyan-fg">Loss.__init__</span><span class="ansi-blue-intense-fg ansi-bold">(self, reduction, name)</span>
<span class="ansi-green-fg">     73</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">__init__</span>(<span style="color: rgb(0,135,0)">self</span>, reduction<span style="color: rgb(98,98,98)">=</span>losses_utils<span style="color: rgb(98,98,98)">.</span>ReductionV2<span style="color: rgb(98,98,98)">.</span>AUTO, name<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">None</span>):
<span class="ansi-green-fg">     74</span>   <span style="color: rgb(175,0,0)">"""Initializes `Loss` class.</span>
<span class="ansi-green-fg">     75</span> 
<span class="ansi-green-fg">     76</span> <span style="color: rgb(175,0,0)">  Args:</span>
<span class="ansi-green-intense-fg ansi-bold">   (...)</span>
<span class="ansi-green-fg">     86</span> <span style="color: rgb(175,0,0)">    name: Optional name for the instance.</span>
<span class="ansi-green-fg">     87</span> <span style="color: rgb(175,0,0)">  """</span>
<span class="ansi-green-intense-fg ansi-bold">---&gt; 88</span>   <span class="ansi-yellow-bg">losses_utils</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">ReductionV2</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">validate</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">reduction</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">     89</span>   <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>reduction <span style="color: rgb(98,98,98)">=</span> reduction
<span class="ansi-green-fg">     90</span>   <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>name <span style="color: rgb(98,98,98)">=</span> name

File <span class="ansi-green-intense-fg ansi-bold">~\anaconda3\envs\ds2022\lib\site-packages\keras\utils\losses_utils.py:83</span>, in <span class="ansi-cyan-fg">ReductionV2.validate</span><span class="ansi-blue-intense-fg ansi-bold">(cls, key)</span>
<span class="ansi-green-fg">     80</span> <span style="color: rgb(175,0,255)">@classmethod</span>
<span class="ansi-green-fg">     81</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> <span style="color: rgb(0,0,255)">validate</span>(<span style="color: rgb(0,135,0)">cls</span>, key):
<span class="ansi-green-fg">     82</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> key <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span style="color: rgb(0,135,0)">cls</span><span style="color: rgb(98,98,98)">.</span>all():
<span class="ansi-green-intense-fg ansi-bold">---&gt; 83</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>(
<span class="ansi-green-fg">     84</span>         <span style="color: rgb(175,0,0)">f</span><span style="color: rgb(175,0,0)">'</span><span style="color: rgb(175,0,0)">Invalid Reduction Key: </span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span>key<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">. Expected keys are </span><span style="color: rgb(175,0,0)">"</span><span class="ansi-bold" style="color: rgb(175,95,135)">{</span><span style="color: rgb(0,135,0)">cls</span><span style="color: rgb(98,98,98)">.</span>all()<span class="ansi-bold" style="color: rgb(175,95,135)">}</span><span style="color: rgb(175,0,0)">"</span><span style="color: rgb(175,0,0)">'</span>)

<span class="ansi-red-intense-fg ansi-bold">ValueError</span>: Invalid Reduction Key: (&lt;tf.Tensor: shape=(200,), dtype=float64, numpy=
array([1.85275314, 2.74120989, 3.40260411, 3.86480278, 2.40210613,
       1.31985631, 2.34901823, 2.284458  , 2.46252602, 2.18431527,
       3.42583962, 3.31318298, 2.88220399, 3.00733549, 3.52272213,
       1.66944258, 2.78072594, 3.14321   , 2.73648107, 2.75313851,
       3.2436347 , 2.14381816, 3.05543125, 2.94008656, 2.93801235,
       2.22203501, 3.62159774, 3.67799122, 3.88907751, 3.49826642,
       2.19885106, 1.59326367, 3.05068809, 2.93449805, 3.46192861,
       2.8305301 , 2.65407435, 3.26883764, 3.29059035, 2.83562788,
       4.0502773 , 3.43474563, 3.27274234, 3.19520052, 3.51077918,
       3.63272229, 3.3809    , 2.9575735 , 4.36618343, 3.56182648,
       3.76859893, 3.32632733, 3.05464109, 3.63700817, 3.40334311,
       3.75810104, 3.3876501 , 3.93202274, 4.1764372 , 4.82331873,
       3.77892584, 4.19113873, 4.02716554, 2.8140508 , 3.89742531,
       3.60297001, 3.78792647, 4.0092427 , 4.12447136, 3.36998897,
       4.16143963, 4.11805975, 3.96581155, 4.97139214, 3.94345412,
       3.24070572, 4.39414946, 3.61984367, 3.7961167 , 4.43103737,
       3.98777658, 3.74862454, 4.31428866, 4.36668221, 5.19459834,
       4.02190318, 4.33428583, 3.90140176, 4.13467048, 4.40997807,
       5.20239075, 3.97708338, 3.98520656, 3.85117406, 3.74914404,
       4.67870071, 4.46237022, 3.5934099 , 3.72163712, 4.45973941,
       4.90984728, 4.68912881, 4.73814294, 4.90688137, 4.0750479 ,
       4.23430813, 4.66331426, 5.35246718, 4.94899606, 4.66880361,
       5.24563146, 5.59203164, 5.34975923, 6.01682146, 5.5964797 ,
       4.47640444, 5.09951338, 4.86402962, 4.69337013, 5.07779304,
       4.2768764 , 5.47826588, 5.11181129, 4.39901233, 5.7005923 ,
       4.52352963, 4.33796533, 5.02068374, 4.77431511, 5.96587303,
       5.42926138, 5.81810993, 4.82592311, 5.30058169, 4.59379835,
       5.54801606, 4.82574257, 4.95804583, 5.68060751, 4.74627408,
       5.34710083, 4.81312113, 4.59568804, 5.90109513, 4.72232315,
       5.59658612, 6.65415208, 6.28138025, 5.30809268, 6.83666644,
       5.21272686, 5.90825308, 5.4791133 , 4.8048449 , 6.59485311,
       4.48556154, 5.45602146, 6.28308931, 6.02768964, 5.73520098,
       5.83256331, 5.65601759, 5.96936635, 6.39725355, 6.31677447,
       5.35624566, 6.36368854, 6.16924599, 5.2890948 , 5.69414292,
       5.88715305, 5.90918155, 5.57644188, 6.44633357, 6.30203093,
       5.99376212, 6.23239137, 5.94669229, 6.61552144, 5.4339177 ,
       6.32816074, 7.09476023, 6.21127041, 6.35112611, 7.07523998,
       6.01315549, 6.62756748, 6.15184238, 5.9967824 , 5.99419475,
       6.47049184, 6.42301354, 5.69924333, 7.15647568, 6.18485576,
       6.44671813, 6.05208212, 6.0912541 , 6.61551979, 6.77698431])&gt;, &lt;tf.Tensor: shape=(200,), dtype=float64, numpy=
array([2.49047318, 2.51107766, 2.53168214, 2.55228662, 2.5728911 ,
       2.59349559, 2.61410007, 2.63470455, 2.65530903, 2.67591351,
       2.69651799, 2.71712247, 2.73772696, 2.75833144, 2.77893592,
       2.7995404 , 2.82014488, 2.84074936, 2.86135384, 2.88195832,
       2.90256281, 2.92316729, 2.94377177, 2.96437625, 2.98498073,
       3.00558521, 3.02618969, 3.04679418, 3.06739866, 3.08800314,
       3.10860762, 3.1292121 , 3.14981658, 3.17042106, 3.19102555,
       3.21163003, 3.23223451, 3.25283899, 3.27344347, 3.29404795,
       3.31465243, 3.33525692, 3.3558614 , 3.37646588, 3.39707036,
       3.41767484, 3.43827932, 3.4588838 , 3.47948829, 3.50009277,
       3.52069725, 3.54130173, 3.56190621, 3.58251069, 3.60311517,
       3.62371966, 3.64432414, 3.66492862, 3.6855331 , 3.70613758,
       3.72674206, 3.74734654, 3.76795103, 3.78855551, 3.80915999,
       3.82976447, 3.85036895, 3.87097343, 3.89157791, 3.9121824 ,
       3.93278688, 3.95339136, 3.97399584, 3.99460032, 4.0152048 ,
       4.03580928, 4.05641377, 4.07701825, 4.09762273, 4.11822721,
       4.13883169, 4.15943617, 4.18004065, 4.20064514, 4.22124962,
       4.2418541 , 4.26245858, 4.28306306, 4.30366754, 4.32427202,
       4.34487651, 4.36548099, 4.38608547, 4.40668995, 4.42729443,
       4.44789891, 4.46850339, 4.48910788, 4.50971236, 4.53031684,
       4.55092132, 4.5715258 , 4.59213028, 4.61273476, 4.63333925,
       4.65394373, 4.67454821, 4.69515269, 4.71575717, 4.73636165,
       4.75696613, 4.77757062, 4.7981751 , 4.81877958, 4.83938406,
       4.85998854, 4.88059302, 4.9011975 , 4.92180199, 4.94240647,
       4.96301095, 4.98361543, 5.00421991, 5.02482439, 5.04542887,
       5.06603336, 5.08663784, 5.10724232, 5.1278468 , 5.14845128,
       5.16905576, 5.18966024, 5.21026473, 5.23086921, 5.25147369,
       5.27207817, 5.29268265, 5.31328713, 5.33389161, 5.3544961 ,
       5.37510058, 5.39570506, 5.41630954, 5.43691402, 5.4575185 ,
       5.47812298, 5.49872747, 5.51933195, 5.53993643, 5.56054091,
       5.58114539, 5.60174987, 5.62235435, 5.64295884, 5.66356332,
       5.6841678 , 5.70477228, 5.72537676, 5.74598124, 5.76658572,
       5.7871902 , 5.80779469, 5.82839917, 5.84900365, 5.86960813,
       5.89021261, 5.91081709, 5.93142157, 5.95202606, 5.97263054,
       5.99323502, 6.0138395 , 6.03444398, 6.05504846, 6.07565294,
       6.09625743, 6.11686191, 6.13746639, 6.15807087, 6.17867535,
       6.19927983, 6.21988431, 6.2404888 , 6.26109328, 6.28169776,
       6.30230224, 6.32290672, 6.3435112 , 6.36411568, 6.38472017,
       6.40532465, 6.42592913, 6.44653361, 6.46713809, 6.48774257,
       6.50834705, 6.52895154, 6.54955602, 6.5701605 , 6.59076498])&gt;). Expected keys are "('auto', 'none', 'sum', 'sum_over_batch_size')"</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이는 오류</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="tf.keras.Sequential">
<a class="anchor" href="#tf.keras.Sequential" aria-hidden="true"><span class="octicon octicon-link"></span></a>tf.keras.Sequential<a class="anchor-link" href="#tf.keras.Sequential"> </a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> $\hat{y}_i=\hat{\beta}_0+\hat{\beta}_1x_i$ 의 서로다른 표현</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">graphviz</span>
<span class="k">def</span> <span class="nf">gv</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">return</span> <span class="n">graphviz</span><span class="o">.</span><span class="n">Source</span><span class="p">(</span><span class="s1">'digraph G{ rankdir="LR"'</span><span class="o">+</span><span class="n">s</span> <span class="o">+</span> <span class="s1">'; }'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 방식1: 스칼라버전, <code>bias=False</code></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gv</span><span class="p">(</span><span class="s1">''' </span>
<span class="s1">    "1" -&gt; "beta0_hat + x*beta1_hat,    bias=False"[label="* beta0_hat"]</span>
<span class="s1">    "x" -&gt; "beta0_hat + x*beta1_hat,    bias=False"[label="* beta1_hat"]</span>
<span class="s1">    "beta0_hat + x*beta1_hat,    bias=False" -&gt; "yhat"[label="indentity"]</span>
<span class="s1">    '''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: G Pages: 1 -->
<svg width="604pt" height="98pt" viewbox="0.00 0.00 603.87 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-94 599.873,-94 599.873,4 -4,4"></polygon>
<!-- 1 -->
<g id="node1" class="node"><title>1</title>
<ellipse fill="none" stroke="black" cx="27" cy="-72" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-68.3" font-family="Times New Roman,serif" font-size="14.00">1</text>
</g>
<!-- beta0_hat + x*beta1_hat, &#160;&#160;&#160;bias=False -->
<g id="node2" class="node"><title>beta0_hat + x*beta1_hat,    bias=False</title>
<ellipse fill="none" stroke="black" cx="306.437" cy="-45" rx="151.373" ry="18"></ellipse>
<text text-anchor="middle" x="306.437" y="-41.3" font-family="Times New Roman,serif" font-size="14.00">beta0_hat + x*beta1_hat,    bias=False</text>
</g>
<!-- 1&#45;&gt;beta0_hat + x*beta1_hat, &#160;&#160;&#160;bias=False -->
<g id="edge1" class="edge"><title>1-&gt;beta0_hat + x*beta1_hat,    bias=False</title>
<path fill="none" stroke="black" d="M53.8514,-69.4842C82.7362,-66.6731 131.643,-61.9135 178.698,-57.3341"></path>
<polygon fill="black" stroke="black" points="179.09,-60.8127 188.703,-56.3604 178.411,-53.8456 179.09,-60.8127"></polygon>
<text text-anchor="middle" x="104.5" y="-70.8" font-family="Times New Roman,serif" font-size="14.00">* beta0_hat</text>
</g>
<!-- yhat -->
<g id="node4" class="node"><title>yhat</title>
<ellipse fill="none" stroke="black" cx="568.873" cy="-45" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="568.873" y="-41.3" font-family="Times New Roman,serif" font-size="14.00">yhat</text>
</g>
<!-- beta0_hat + x*beta1_hat, &#160;&#160;&#160;bias=False&#45;&gt;yhat -->
<g id="edge3" class="edge"><title>beta0_hat + x*beta1_hat,    bias=False-&gt;yhat</title>
<path fill="none" stroke="black" d="M458.179,-45C485.641,-45 511.853,-45 531.764,-45"></path>
<polygon fill="black" stroke="black" points="531.859,-48.5001 541.859,-45 531.859,-41.5001 531.859,-48.5001"></polygon>
<text text-anchor="middle" x="499.873" y="-48.8" font-family="Times New Roman,serif" font-size="14.00">indentity</text>
</g>
<!-- x -->
<g id="node3" class="node"><title>x</title>
<ellipse fill="none" stroke="black" cx="27" cy="-18" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">x</text>
</g>
<!-- x&#45;&gt;beta0_hat + x*beta1_hat, &#160;&#160;&#160;bias=False -->
<g id="edge2" class="edge"><title>x-&gt;beta0_hat + x*beta1_hat,    bias=False</title>
<path fill="none" stroke="black" d="M53.8514,-20.5158C82.7362,-23.3269 131.643,-28.0865 178.698,-32.6659"></path>
<polygon fill="black" stroke="black" points="178.411,-36.1544 188.703,-33.6396 179.09,-29.1873 178.411,-36.1544"></polygon>
<text text-anchor="middle" x="104.5" y="-31.8" font-family="Times New Roman,serif" font-size="14.00">* beta1_hat</text>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 방식2: 스칼라버전, <code>bias=True</code></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gv</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">"x" -&gt; "x*beta1_hat,    bias=True"[label="*beta1_hat"] ;</span>
<span class="s1">"x*beta1_hat,    bias=True" -&gt; "yhat"[label="indentity"] '''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: G Pages: 1 -->
<svg width="505pt" height="44pt" viewbox="0.00 0.00 504.98 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-40 500.982,-40 500.982,4 -4,4"></polygon>
<!-- x -->
<g id="node1" class="node"><title>x</title>
<ellipse fill="none" stroke="black" cx="27" cy="-18" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="27" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">x</text>
</g>
<!-- x*beta1_hat, &#160;&#160;&#160;bias=True -->
<g id="node2" class="node"><title>x*beta1_hat,    bias=True</title>
<ellipse fill="none" stroke="black" cx="254.991" cy="-18" rx="103.982" ry="18"></ellipse>
<text text-anchor="middle" x="254.991" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">x*beta1_hat,    bias=True</text>
</g>
<!-- x&#45;&gt;x*beta1_hat, &#160;&#160;&#160;bias=True -->
<g id="edge1" class="edge"><title>x-&gt;x*beta1_hat,    bias=True</title>
<path fill="none" stroke="black" d="M54.3663,-18C76.0502,-18 108.371,-18 140.722,-18"></path>
<polygon fill="black" stroke="black" points="140.751,-21.5001 150.751,-18 140.751,-14.5001 140.751,-21.5001"></polygon>
<text text-anchor="middle" x="102.5" y="-21.8" font-family="Times New Roman,serif" font-size="14.00">*beta1_hat</text>
</g>
<!-- yhat -->
<g id="node3" class="node"><title>yhat</title>
<ellipse fill="none" stroke="black" cx="469.982" cy="-18" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="469.982" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">yhat</text>
</g>
<!-- x*beta1_hat, &#160;&#160;&#160;bias=True&#45;&gt;yhat -->
<g id="edge2" class="edge"><title>x*beta1_hat,    bias=True-&gt;yhat</title>
<path fill="none" stroke="black" d="M359.055,-18C385.458,-18 412.143,-18 432.609,-18"></path>
<polygon fill="black" stroke="black" points="432.71,-21.5001 442.71,-18 432.71,-14.5001 432.71,-21.5001"></polygon>
<text text-anchor="middle" x="400.982" y="-21.8" font-family="Times New Roman,serif" font-size="14.00">indentity</text>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 방식3: 벡터버전, <code>bias=False</code></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gv</span><span class="p">(</span><span class="s1">'''</span>
<span class="s1">"X=[1 x]" -&gt; "X@beta_hat,    bias=False"[label="@beta_hat"] ;</span>
<span class="s1">"X@beta_hat,    bias=False" -&gt; "yhat"[label="indentity"] '''</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: G Pages: 1 -->
<svg width="537pt" height="44pt" viewbox="0.00 0.00 536.77 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-40 532.774,-40 532.774,4 -4,4"></polygon>
<!-- X=[1 x] -->
<g id="node1" class="node"><title>X=[1 x]</title>
<ellipse fill="none" stroke="black" cx="39.6465" cy="-18" rx="39.7935" ry="18"></ellipse>
<text text-anchor="middle" x="39.6465" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">X=[1 x]</text>
</g>
<!-- X@beta_hat, &#160;&#160;&#160;bias=False -->
<g id="node2" class="node"><title>X@beta_hat,    bias=False</title>
<ellipse fill="none" stroke="black" cx="283.533" cy="-18" rx="107.482" ry="18"></ellipse>
<text text-anchor="middle" x="283.533" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">X@beta_hat,    bias=False</text>
</g>
<!-- X=[1 x]&#45;&gt;X@beta_hat, &#160;&#160;&#160;bias=False -->
<g id="edge1" class="edge"><title>X=[1 x]-&gt;X@beta_hat,    bias=False</title>
<path fill="none" stroke="black" d="M79.5098,-18C103.189,-18 134.816,-18 166.047,-18"></path>
<polygon fill="black" stroke="black" points="166.162,-21.5001 176.162,-18 166.162,-14.5001 166.162,-21.5001"></polygon>
<text text-anchor="middle" x="127.793" y="-21.8" font-family="Times New Roman,serif" font-size="14.00">@beta_hat</text>
</g>
<!-- yhat -->
<g id="node3" class="node"><title>yhat</title>
<ellipse fill="none" stroke="black" cx="501.774" cy="-18" rx="27" ry="18"></ellipse>
<text text-anchor="middle" x="501.774" y="-14.3" font-family="Times New Roman,serif" font-size="14.00">yhat</text>
</g>
<!-- X@beta_hat, &#160;&#160;&#160;bias=False&#45;&gt;yhat -->
<g id="edge2" class="edge"><title>X@beta_hat,    bias=False-&gt;yhat</title>
<path fill="none" stroke="black" d="M391.07,-18C417.578,-18 444.214,-18 464.601,-18"></path>
<polygon fill="black" stroke="black" points="464.658,-21.5001 474.658,-18 464.658,-14.5001 464.658,-21.5001"></polygon>
<text text-anchor="middle" x="432.774" y="-21.8" font-family="Times New Roman,serif" font-size="14.00">indentity</text>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="풀이1:-벡터버전,-사용자정의-손실함수">
<a class="anchor" href="#%ED%92%80%EC%9D%B41:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>풀이1: 벡터버전, 사용자정의 손실함수<a class="anchor-link" href="#%ED%92%80%EC%9D%B41:-%EB%B2%A1%ED%84%B0%EB%B2%84%EC%A0%84,-%EC%82%AC%EC%9A%A9%EC%9E%90%EC%A0%95%EC%9D%98-%EC%86%90%EC%8B%A4%ED%95%A8%EC%88%98"> </a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 포인트</p>
<div class="highlight"><pre><span></span><span class="c1"># 포인트1: 네트워크 생성 </span>
<span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>

<span class="c1"># 포인트2: 네트워크의 아키텍처 설계 </span>
<span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span><span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> 

<span class="c1"># 포인트3: 네트워크 컴파일 = 아키텍처 + 손실함수 + 옵티마이저</span>
<span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">loss_fn2</span><span class="p">)</span>

<span class="c1"># 포인트4: 미분 &amp; update </span>
<span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">50000</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span> 
<span class="n">epsilon</span> <span class="o">=</span> <span class="n">tnp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">epsilon</span>
<span class="n">y_true</span> <span class="o">=</span> <span class="mf">2.5</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">'float64'</span><span class="p">),</span><span class="n">x</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TensorShape([200, 2]), TensorShape([200, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 네트워크 생성</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ValueError</span>                                Traceback (most recent call last)
Input <span class="ansi-green-intense-fg ansi-bold">In [16]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; 1</span> <span class="ansi-yellow-bg">net</span><span class="ansi-yellow-bg" style="color: rgb(98,98,98)">.</span><span class="ansi-yellow-bg">summary</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-intense-fg ansi-bold">~\anaconda3\envs\ds2022\lib\site-packages\keras\engine\training.py:2775</span>, in <span class="ansi-cyan-fg">Model.summary</span><span class="ansi-blue-intense-fg ansi-bold">(self, line_length, positions, print_fn, expand_nested, show_trainable)</span>
<span class="ansi-green-fg">   2753</span> <span style="color: rgb(175,0,0)">"""Prints a string summary of the network.</span>
<span class="ansi-green-fg">   2754</span> 
<span class="ansi-green-fg">   2755</span> <span style="color: rgb(175,0,0)">Args:</span>
<span class="ansi-green-intense-fg ansi-bold">   (...)</span>
<span class="ansi-green-fg">   2772</span> <span style="color: rgb(175,0,0)">    ValueError: if `summary()` is called before the model is built.</span>
<span class="ansi-green-fg">   2773</span> <span style="color: rgb(175,0,0)">"""</span>
<span class="ansi-green-fg">   2774</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span style="color: rgb(0,135,0)">self</span><span style="color: rgb(98,98,98)">.</span>built:
<span class="ansi-green-intense-fg ansi-bold">-&gt; 2775</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>(
<span class="ansi-green-fg">   2776</span>       <span style="color: rgb(175,0,0)">'</span><span style="color: rgb(175,0,0)">This model has not yet been built. </span><span style="color: rgb(175,0,0)">'</span>
<span class="ansi-green-fg">   2777</span>       <span style="color: rgb(175,0,0)">'</span><span style="color: rgb(175,0,0)">Build the model first by calling `build()` or by calling </span><span style="color: rgb(175,0,0)">'</span>
<span class="ansi-green-fg">   2778</span>       <span style="color: rgb(175,0,0)">'</span><span style="color: rgb(175,0,0)">the model on a batch of data.</span><span style="color: rgb(175,0,0)">'</span>)
<span class="ansi-green-fg">   2779</span> layer_utils<span style="color: rgb(98,98,98)">.</span>print_summary(
<span class="ansi-green-fg">   2780</span>     <span style="color: rgb(0,135,0)">self</span>,
<span class="ansi-green-fg">   2781</span>     line_length<span style="color: rgb(98,98,98)">=</span>line_length,
<span class="ansi-green-intense-fg ansi-bold">   (...)</span>
<span class="ansi-green-fg">   2784</span>     expand_nested<span style="color: rgb(98,98,98)">=</span>expand_nested,
<span class="ansi-green-fg">   2785</span>     show_trainable<span style="color: rgb(98,98,98)">=</span>show_trainable)

<span class="ansi-red-intense-fg ansi-bold">ValueError</span>: This model has not yet been built. Build the model first by calling `build()` or by calling the model on a batch of data.</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>현재 아무것도 없음</li>
<li>다음과 같이 layer를 만들어야 함</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 네트워크의 아키텍처 설계</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span><span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="c1"># 뼈대, 아키텍처 설계 = yhat을 만들 계획</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 dense_1 (Dense)             (None, 1)                 2         
                                                                 
 dense_2 (Dense)             (None, 1)                 1         
                                                                 
=================================================================
Total params: 3
Trainable params: 3
Non-trainable params: 0
_________________________________________________________________
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>무엇인가 나왔음!</li>
<li>layer가 추가된 것임</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>units=1:</code> 출력의 차원</li>
<li>
<code>input_shape:</code> x의 dimension</li>
<li>
<code>use_bias:</code> bias 사용여부</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 네트워크 컴파일(아키텍처, 손실함수, 옵티마이저)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss_fn2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">yhat</span><span class="p">):</span> <span class="c1"># 손실함수 정의, 입력값이 항상 y, yhat이 와야함</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="c1"># 옵티마이저 선택</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">loss_fn2</span><span class="p">)</span> <span class="c1"># 컴파일 = 아키텍처 + 손실함수 + 옵티마이저</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>네트워크의 형태(아키텍처), 손실함수, 손실함수를 미분할 옵티마이저 전달</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>-</code> 네트워크 적합: <code>for문-미분-업데이트</code>의 기능</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch 1/10
1/1 [==============================] - 0s 332ms/step - loss: 0.2631
Epoch 2/10
1/1 [==============================] - 0s 6ms/step - loss: 0.2631
Epoch 3/10
1/1 [==============================] - 0s 4ms/step - loss: 0.2631
Epoch 4/10
1/1 [==============================] - 0s 6ms/step - loss: 0.2631
Epoch 5/10
1/1 [==============================] - 0s 9ms/step - loss: 0.2631
Epoch 6/10
1/1 [==============================] - 0s 6ms/step - loss: 0.2631
Epoch 7/10
1/1 [==============================] - 0s 5ms/step - loss: 0.2631
Epoch 8/10
1/1 [==============================] - 0s 6ms/step - loss: 0.2631
Epoch 9/10
1/1 [==============================] - 0s 5ms/step - loss: 0.2631
Epoch 10/10
1/1 [==============================] - 0s 7ms/step - loss: 0.2631
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x1c4f4d66eb0&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<code>verbose=0</code>사용 -&gt; 적합되는 과정 생략</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span> <span class="c1"># 미분 &amp; update의 반복, epochs= 반복 수, batch_size= 일단 N</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;keras.callbacks.History at 0x1c4f4ef3a60&gt;</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이에 대해 적합된 결과는 <code>net.weights</code>를 통해 알 수 있음</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span><span class="o">.</span><span class="n">weights</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&lt;tf.Variable 'dense_1/kernel:0' shape=(2, 1) dtype=float32, numpy=
 array([[2.4904754],
        [4.1002874]], dtype=float32)&gt;]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="n">정리</span><span class="p">:</span>
<span class="mf">1.</span> <span class="n">net</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="mf">2.</span> <span class="n">net</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,),</span><span class="n">use_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="mi">3</span><span class="o">-</span><span class="mf">1.</span> <span class="k">def</span> <span class="nf">loss_fn2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">yhat</span><span class="p">):</span> <span class="c1"># 입력값이 항상 y, yhat이 와야함</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">yhat</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
<span class="mi">3</span><span class="o">-</span><span class="mf">2.</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
<span class="mi">3</span><span class="o">-</span><span class="mf">3.</span> <span class="n">opt</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
<span class="mi">3</span><span class="o">-</span><span class="mf">4.</span> <span class="n">net</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="n">loss_fn2</span><span class="p">)</span>
<span class="mf">4.</span> <span class="n">net</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
<span class="mf">5.</span> <span class="n">net</span><span class="o">.</span><span class="n">weights</span>

<span class="mf">1.</span> <span class="n">네트워크</span> <span class="n">생성</span>
<span class="mf">2.</span> <span class="n">하나의</span> <span class="n">layer</span><span class="p">(</span><span class="n">층</span><span class="p">)</span> <span class="n">추가</span><span class="p">(</span><span class="n">여러</span> <span class="n">layer도</span> <span class="n">추가</span> <span class="n">가능</span><span class="p">)</span>
  <span class="n">아키텍처</span> <span class="n">설계</span><span class="p">:</span> <span class="n">입력을</span> <span class="n">가지고</span> <span class="n">출력을</span> <span class="n">어떠한</span> <span class="n">방식으로</span> <span class="n">만들</span> <span class="n">것인지</span> <span class="n">컴퓨터에게</span> <span class="n">전달해주는</span> <span class="n">것</span><span class="o">.</span> <span class="n">여기서</span><span class="p">,</span> <span class="n">x를</span> <span class="n">가지고</span> <span class="n">yhat을</span> <span class="n">어떠한</span> <span class="n">방식으로</span> <span class="n">만들</span> <span class="n">것인지</span> <span class="n">컴퓨터에게</span> <span class="n">전달해주는</span> <span class="n">것</span><span class="o">.</span>
<span class="mi">3</span><span class="o">-</span><span class="mf">1.</span> <span class="n">손실함수</span> <span class="n">정의</span>
<span class="mi">3</span><span class="o">-</span><span class="mf">2.</span> <span class="n">옵티마이저</span> <span class="n">정의</span> <span class="n">위해</span> <span class="n">학습율</span> <span class="n">설정</span>
<span class="mi">3</span><span class="o">-</span><span class="mf">3.</span> <span class="n">옵티마이저</span> <span class="n">오브젝트</span> <span class="n">생성</span>
<span class="mi">3</span><span class="o">-</span><span class="mf">4.</span> <span class="n">옵티마이저</span> <span class="n">오브젝트</span><span class="p">,</span> <span class="n">손실함수를</span> <span class="n">네트워크에</span> <span class="n">알려줌</span>
<span class="mf">4.</span> <span class="n">미분</span> <span class="o">&amp;</span> <span class="n">업데이트의</span> <span class="n">반복</span><span class="p">(</span><span class="n">for문</span><span class="p">)</span>
<span class="mf">5.</span> <span class="n">결과값</span> <span class="n">확인</span>
</pre></div>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="ki5n2/charcoal"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/charcoal/2022/04/06/DS.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/charcoal/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/charcoal/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/charcoal/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/ki5n2" target="_blank" title="ki5n2"><svg class="svg-icon grey"><use xlink:href="/charcoal/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
